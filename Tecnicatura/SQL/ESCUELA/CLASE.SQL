select *
from ARTICULOS;

select *
from Tipo_De_Lavandina;


select *
from Datos_De_Compra;

SELECT *
FROM Tipo_De_LavaVajilla;

-- CONSIGNA: Obtener todos los datos de compras historias.

select DDC_ID AS CODIGO_DE_COMPRA, table2.TLVJ_NAME AS NOMBRE_TIPO_PRODUCTO
from Datos_De_Compra table1
LEFT JOIN Tipo_De_LavaVajilla table2 ON table1.DDC_TLVJ_ID = table2.TLVJ_ID;


SELECT *
FROM ARTICULOS;

SELECT *
FROM PRECIO_ARTICULOS;

SELECT PA.PA_ID AS CODIGO, A.A_NAME, C.C_NAME, PA.PA_VALOR_PRECIO
FROM PRECIO_ARTICULOS PA
JOIN ARTICULOS A ON PA.PA_A_ID = A.A_ID
JOIN CLIENTES C ON C.C_ID = PA.PA_C_ID;

SELECT *
FROM CLIENTES;

SELECT *
FROM VENTAS;

SELECT V.V_ID AS CODIGO, A.A_NAME AS ARTICULO, PA.PA_VALOR_PRECIO AS PRECIO, C.C_NAME
FROM VENTAS V -- PRINCIPAL
join ARTICULOS A on A.A_ID = V.V_A_ID -- SECUNDARIA
join PRECIO_ARTICULOS PA on A.A_ID = PA.PA_A_ID -- SECUNDARIA
JOIN CLIENTES C on PA.PA_C_ID = C.C_ID; -- SECUNDARIA


-- Vistas materializadas
CREATE VIEW REPORTE_DE_PRECIOS AS
SELECT V.V_ID AS CODIGO, A.A_NAME AS ARTICULO, PA.PA_VALOR_PRECIO AS PRECIO, C.C_NAME
FROM VENTAS V -- PRINCIPAL
         join ARTICULOS A on A.A_ID = V.V_A_ID -- SECUNDARIA
         join PRECIO_ARTICULOS PA on A.A_ID = PA.PA_A_ID -- SECUNDARIA
         JOIN CLIENTES C on PA.PA_C_ID = C.C_ID; -- SECUNDARIA


SELECT *
FROM CLIENTES C
WHERE C.CLI_TDC_ID = (SELECT TDC.TDC_ID
                        FROM TIPOS_DE_CLIENTES TDC
                        WHERE TDC.TDC_ID = 2);



-- Calcular valor entre columnas
SELECT V.V_ID AS CODIGO, A.A_NAME AS ARTICULO, (PA.PA_VALOR_PRECIO * 25) AS PRECIO, C.C_NAME
FROM VENTAS V -- PRINCIPAL
         join ARTICULOS A on A.A_ID = V.V_A_ID -- SECUNDARIA
         join PRECIO_ARTICULOS PA on A.A_ID = PA.PA_A_ID -- SECUNDARIA
         JOIN CLIENTES C on PA.PA_C_ID = C.C_ID; -- SECUNDARIA

-- Crear procedimientos almacenados
CREATE PROCEDURE CREAR_ARTICULO (IN nombre VARCHAR(20), OUT stock INT)
BEGIN
    insert into ARTICULOS (A_NAME, A_STOCK) VALUE (nombre, stock);
END;


  SELECT *
    FROM ARTICULOS;


select *
    from CLIENTES;

CREATE TABLE PRODUCTOS (
    PRO_ID INT  PRIMARY KEY ,
    PRO_NOMBRE VARCHAR(100),
    PRO_PRECIO INT
);

INSERT INTO PRODUCTOS (PRO_ID, PRO_NOMBRE, PRO_PRECIO) VALUE (1, 'SILLA', 100);
INSERT INTO PRODUCTOS (PRO_ID, PRO_NOMBRE, PRO_PRECIO) VALUE (2, 'MESA', 300);
INSERT INTO PRODUCTOS (PRO_ID, PRO_NOMBRE, PRO_PRECIO) VALUE (3, 'CAMA', 500);
INSERT INTO PRODUCTOS (PRO_ID, PRO_NOMBRE, PRO_PRECIO) VALUE (4, 'MODULAR', 100);
INSERT INTO PRODUCTOS (PRO_ID, PRO_NOMBRE, PRO_PRECIO) VALUE (5, 'SOMNIER', 1000);

SELECT *
FROM PRODUCTOS;



 SELECT *
     FROM TIPOS_DE_CLIENTES;

SELECT *
FROM CLIENTES;

ALTER TABLE CLIENTES
    ADD CLI_TDC_ID INT;

ALTER TABLE CLIENTES
    ADD FOREIGN KEY (CLI_TDC_ID) REFERENCES TIPOS_DE_CLIENTES(TDC_ID);

UPDATE CLIENTES C SET CLI_TDC_ID = 2
where C.C_ID = 3;




INSERT INTO TIPOS_DE_CLIENTES (TDC_ID, TDC_NOMBRE, TDC_PORCENTAJE) VALUE
    (1, 'MAYORISTA',  20);
INSERT INTO TIPOS_DE_CLIENTES (TDC_ID, TDC_NOMBRE, TDC_PORCENTAJE) VALUE
    (2, 'MINORISTA',  25);
INSERT INTO TIPOS_DE_CLIENTES (TDC_ID, TDC_NOMBRE, TDC_PORCENTAJE) VALUE
    (3, 'ESPECIALES',  10);

-- CONSIGNA: OBTENER TODAS LAS VENTAS CON FECHA, ARTICULO, NOMBRE DE CLIENTES Y TIPOS CLIENTES
VENTAS (ID, FECHA, ARTICULO, CLIENTE)
ARTICULOS (ID, NOMBRE)
CLIENTES (ID, NOMBRE, TIPO_CLIENTE)
TIPOS_DE_CLIENTES (ID, NOMBRE )


-- Reporte de CLIENTES
SELECT C_NAME, C_CUIT, TDC.TDC_NOMBRE
FROM CLIENTES C
JOIN TIPOS_DE_CLIENTES TDC ON C.CLI_TDC_ID = TDC.TDC_ID;

-- Calcular valor entre columnas
SELECT V.V_ID AS CODIGO, A.A_NAME AS ARTICULO, (PA.PA_VALOR_PRECIO * 100) AS PRECIO, C.C_NAME
FROM VENTAS V -- PRINCIPAL
         join ARTICULOS A on A.A_ID = V.V_A_ID -- SECUNDARIA
         join PRECIO_ARTICULOS PA on A.A_ID = PA.PA_A_ID -- SECUNDARIA
         JOIN CLIENTES C on PA.PA_C_ID = C.C_ID; -- SECUNDARIA


-- GERENTE NECESITA UN REPORTE DE PRECIOS DE LISTA PARA LOS MAYORISTAS
SELECT PROD.PRO_NOMBRE, (PROD.PRO_PRECIO * TDC.TDC_PORCENTAJE) + PROD.PRO_PRECIO
FROM PRODUCTOS PROD, TIPOS_DE_CLIENTES TDC
WHERE TDC_ID = 1;


SELECT *
FROM CLIENTES;



((C.PRECIO * (SELECT C.PORCENTAJE FROM TIPOS_DE_CLIENTES WHERE
     TDC_ID = 1)) / 100) + C.PRECIO