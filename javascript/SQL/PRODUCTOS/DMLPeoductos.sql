CREATE DATABASE NOTA_MERCADERIA;

USE NOTA_MERCADERIA;

CREATE TABLE PRODUCTO(
    PRO_ID INT,
    PRO_NAME VARCHAR(40),
    CONSTRAINT PK_PRO PRIMARY KEY (PRO_ID)
);

CREATE TABLE CLIENTE(
    CLI_ID INT,
    CLI_NAME VARCHAR(40),
    CONSTRAINT PK_CLI PRIMARY KEY (CLI_ID)
);

CREATE TABLE NOTA(
    NO_ID INT,
    NO_PRODUCTO_ID INT,
    NO_CLIENTE_ID INT,
    CONSTRAINT PK_NO PRIMARY KEY (NO_ID),
    FOREIGN KEY (NO_PRODUCTO_ID) REFERENCES PRODUCTO(PRO_ID),
    FOREIGN KEY (NO_CLIENTE_ID) REFERENCES CLIENTE(CLI_ID)
);

/* me olvide de poner la columna precio */
USE NOTA_MERCADERIA;
ALTER TABLE PRODUCTO
ADD COLUMN PRO_PRECIO FLOAT;

USE NOTA_MERCADERIA;
SELECT * FROM PRODUCTO;

USE NOTA_MERCADERIA;
INSERT INTO PRODUCTO VALUES (1,'PAPAS', 7 );
INSERT INTO PRODUCTO VALUES (2,'COCA', 12 );
INSERT INTO PRODUCTO VALUES (3,'SPRITE', 12.4 );
INSERT INTO PRODUCTO VALUES (4,'JUGO', 12.7 );


USE NOTA_MERCADERIA;
INSERT INTO CLIENTE VALUES(1,'Lilo');
INSERT INTO CLIENTE VALUES(2,'enzo');
INSERT INTO CLIENTE VALUES(3,'simon');
INSERT INTO CLIENTE VALUES(4,'nahue');

INSERT INTO NOTA VALUES (1, 2, 1);
INSERT INTO NOTA VALUES (2, 1, 4);
INSERT INTO NOTA VALUES (3, 3, 2);
INSERT INTO NOTA VALUES (4, 2, 3);

/* me equivoco el nombre del cliente
asique modifico el dato nombre */
USE NOTA_MERCADERIA;
UPDATE CLIENTE
SET CLI_NAME="lautaro"
WHERE CLI_NAME="lilo";

USE NOTA_MERCADERIA;
SELECT * from CLIENTE;

USE NOTA_MERCADERIA;
ALTER TABLE NOTA
ADD COLUMN NO_CANTIDAD INT,
ADD COLUMN NO_SUBTOTAL FLOAT;

USE NOTA_MERCADERIA;
SELECT * FROM NOTA;  

USE NOTA_MERCADERIA;
UPDATE NOTA  SET NO_CANTIDAD=2 WHERE NO_ID=2;
UPDATE NOTA  SET NO_CANTIDAD=2 WHERE NO_ID=3;
UPDATE NOTA SET NO_CANTIDAD=3 WHERE NO_ID=4;

/* AGREGO EL NO_SUBTOTAL CON LA MULTIPLICACION DEL PRECIO CON LA CANTIDAD DE PRODUCTO;
 */
USE NOTA_MERCADERIA;
 UPDATE NOTA  INNER JOIN PRODUCTO ON PRODUCTO.PRO_ID=NOTA.NO_PRODUCTO_ID
 SET NO_SUBTOTAL=NO_CANTIDAD * PRO_PRECIO;
 /* FROM NOTA JOIN PRODUCTO ON PRODUCTO.PRO_ID=NOTA.NO_PRODUCTO_ID */
 WHERE NO_ID=;

 USE NOTA_MERCADERIA;
 SELECT * FROM NOTA;
 SELECT * FROM PRODUCTO;

/* ELIMINO LOS REGISTROS DE LA TABLA NOTA CON ID 4 */
 USE NOTA_MERCADERIA;
 DELETE FROM NOTA WHERE NO_ID=2;

USE NOTA_MERCADERIA;
UPDATE NOTA SET NO_ID=2 WHERE NO_ID=3; 

USE NOTA_MERCADERIA;
/* INSERT INTO NOTA (NO_ID, NO_CANTIDAD,NO_CLIENTE_ID,NO_PRODUCTO_ID) VALUES (2, 3, 4, 1); */
INSERT INTO NOTA (NO_ID, NO_CANTIDAD,NO_CLIENTE_ID,NO_PRODUCTO_ID) VALUES (3, 1, 3, 2 );
INSERT INTO NOTA (NO_ID, NO_CANTIDAD,NO_CLIENTE_ID,NO_PRODUCTO_ID) VALUES (4, 3, 1, 3 );
INSERT INTO NOTA (NO_ID, NO_CANTIDAD,NO_CLIENTE_ID,NO_PRODUCTO_ID) VALUES (5, 3, 4, 4 );

USE NOTA_MERCADERIA;
DELETE FROM CLIENTE;
TRUNCATE TABLE CLIENTE;
/* BORRA TODOS LOS REGISTROS DE LA TABLA NOTA PORQUE SI NO NO SE 
PUEDE ELIMINAR REGISTROS 
DE LA TABLACLIENTE POR REFERENCIA */
USE NOTA_MERCADERIA;
TRUNCATE TABLE NOTA;
DELETE FROM NOTA;

SELECT * FROM NOTA_MERCADERIA.NOTA;
SELECT * FROM NOTA_MERCADERIA.CLIENTE;


TRUNCATE TABLE NOTA_MERCADERIA.PRODUCTO;
DELETE FROM NOTA_MERCADERIA.PRODUCTO;